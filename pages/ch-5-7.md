---
layout: center
transition: blur-in
---

<ThemeTitle number="6" class="text-8xl!">
React Compiler
</ThemeTitle>

<!--
é€éå‰é¢å¹¾å€‹ç« ç¯€ï¼Œä½ æ‡‰è©²å·²ç¶“æ„Ÿå—åˆ° React åœ¨é‡æ–°æ¸²æŸ“æ–¹é¢çš„è¤‡é›œåº¦ã€‚

æˆ‘å€‘å¿…é ˆç†è§£å¼•ç”¨å€¼èˆ‡åŸå§‹å€¼çš„å·®ç•°ï¼Œä»¥åŠ React åœ¨åº•å±¤é‹ä½œæ™‚çš„ä¸€äº›å¯¦ä½œç´°ç¯€ï¼Œæ‰èƒ½çœŸæ­£æœ‰æ•ˆåœ°æå‡æ•ˆèƒ½ã€‚

é‚£éº¼ï¼Œæœ‰æ²’æœ‰å¯èƒ½è®“ React è‡ªå·±è™•ç†é€™äº›é‡æ–°æ¸²æŸ“çš„å•é¡Œå‘¢ï¼Ÿ

ç­”æ¡ˆå°±æ˜¯ **React Compiler**ã€‚å®ƒçš„ç›®æ¨™æ˜¯è‡ªå‹•æ›¿æˆ‘å€‘å®Œæˆè¨˜æ†¶åŒ–ï¼Œé€²è€Œå¼·åŒ– React çš„æ•´é«”æ•ˆèƒ½ã€‚

æ›å¥è©±èªªï¼Œæˆ‘å€‘å°‡èƒ½æ¸›å°‘æ‰‹å‹•ä½¿ç”¨ `useMemo`ã€`useCallback`ã€`React.memo` ç­‰å·¥å…·ï¼Œä¸¦**æŠŠé€™äº›è¨˜æ†¶åŒ–çš„å·¥ä½œäº¤çµ¦ React Compiler è‡ªå‹•è™•ç†ã€‚**

æ‰€ä»¥é€™å€‹ç« ç¯€ï¼Œæˆ‘å€‘è¦æ·±å…¥æ¢è¨ React 19 å¸¶ä¾†çš„ React Compilerï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿ç”¨ã€æ¸¬è©¦å„å€‹å ´æ™¯ä¸‹çš„æ•ˆæœ
-->

---

# å¦‚ä½•ä½¿ç”¨ React Compilerï¼Ÿ

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Next.js 16ï¼Œå•Ÿç”¨ React Compiler çš„æµç¨‹ç›¸ç•¶ç°¡å–®ã€‚

é¦–å…ˆï¼Œå®‰è£æ‰€éœ€çš„å¥—ä»¶ï¼š

```bash
npm install -D babel-plugin-react-compiler
```

<v-click>

æ¥è‘—ï¼Œåœ¨ `next.config.js` ä¸­å•Ÿç”¨ React Compilerï¼š

```jsx
// next.config.js
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  reactCompiler: true, // ğŸ‘ˆ å•Ÿç”¨ React Compiler
}

export default nextConfig
```

</v-click>

<!--
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Next.js 16ï¼Œå•Ÿç”¨ React Compiler çš„æµç¨‹ç›¸ç•¶ç°¡å–®ã€‚

é¦–å…ˆï¼Œå®‰è£æ‰€éœ€çš„å¥—ä»¶ï¼š

[click]
æ¥è‘—ï¼Œåœ¨ `next.config.js` ä¸­å•Ÿç”¨ React Compilerï¼š
-->

---
layout: center
---

<h1 class="shadow">
React Compiler
<br/>
åœ¨å„å€‹å ´æ™¯ä¸‹çš„è¡¨ç¾ç‹€æ³
</h1>

<!--
æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘å°±ä¾†çœ‹çœ‹ React Compiler åœ¨å„å€‹å ´æ™¯ä¸‹çš„è¡¨ç¾å§ï¼
-->

---

# å¾æœ€ç°¡å–®çš„å ´æ™¯é–‹å§‹

```jsx
export default function Page() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <Button onClick={() => setCount(count + 1)}>Click me</Button>
      <p>count: {count}</p>

      <SlowComponent />
    </div>
  );
}

function SlowComponent() {
  console.log('SlowComponent');
  wait(1000);

  return <p>Slow Component</p>;
}
```

<!--
é€™æ˜¯ä¸€å€‹å¾ˆå–®ç´”çš„å ´æ™¯ï¼Œä¸€å€‹æœ‰ state çš„çˆ¶çµ„ä»¶ï¼Œä»¥åŠä¸€å€‹éœ€è¦èŠ± 1 ç§’æ¸²æŸ“çš„çµ„ä»¶ã€‚

é»æ“Š button æ™‚ï¼Œå› ç‚º state æ”¹è®Šï¼Œå…¨éƒ¨çš„çµ„ä»¶éƒ½æœƒè¢« re-render å˜›

ç¾åœ¨å•Ÿå‹• React Compiler å¾Œï¼Œæˆ‘å€‘é»æ“ŠæŒ‰éˆ•çœ‹çœ‹å¯¦éš›è¡¨ç¾ç‹€æ³ã€‚
-->

---

<Video src="/ch-5/5-7/1.mp4" />

<!--
å¾å½±ç‰‡ä¸­å¯ä»¥çœ‹åˆ°ï¼Œçµæœéå¸¸å®Œç¾ã€‚é€™å€‹ `SlowComponent` ä¸æœƒå› ç‚ºçˆ¶çµ„ä»¶çš„ç‹€æ…‹æ”¹è®Šï¼Œè€Œå°è‡´é‡æ–°æ¸²æŸ“ã€‚

é€™å°±æ˜¯ React Compiler çš„ç”¨è™•ï¼Œä»–æœƒ**è‡ªå‹•åœ°å¹«æˆ‘å€‘å»è¨˜æ†¶åŒ–çµ„ä»¶ã€‚**
-->

---

# ç‹€æ…‹ä¸‹ç§»çš„ä¾‹å­

<Video src="/ch-5/5-7/2.mp4" />

<!--
æ¥è‘—æˆ‘å€‘çœ‹çœ‹ç¬¬ä¸€ç« ç¯€çš„ç‹€æ…‹ä¸‹ç§»ï¼Œçœ‹çœ‹ä»–èƒ½ä¸èƒ½è§£æ±ºå•é¡Œ

å®Œç¾è§£æ±º Re-render å•é¡Œï¼Œé€™ä»£è¡¨æˆ‘å€‘åœ¨çµ•å¤§éƒ¨åˆ†å ´æ™¯ï¼Œæ‡‰è©²éƒ½ä¸éœ€è¦ä½¿ç”¨ç‹€æ…‹ä¸‹ç§»ä¾†è§£æ±ºæ€§èƒ½å•é¡Œã€‚

ä½†è‹¥ä»¥ç¨‹å¼ç¢¼å…§èšæ€§å’Œå¯è®€æ€§ä¾†èªªï¼Œ**å°‡ç›¸é—œçš„ç‹€æ…‹èˆ‡ UI æ”¾åœ¨ä¸€èµ·é‚„æ˜¯æ¯”è¼ƒæ˜æ™ºçš„é¸æ“‡ã€‚**
-->

---

# å…§å®¹ä¸Šç§»çš„ä¾‹å­

<Video src="/ch-5/5-7/3.mp4" />

<!--
æ¥è‘—æˆ‘å€‘ä¾†çœ‹çœ‹å…§å®¹ä¸Šç§»å•é¡Œä»–èƒ½ä¸èƒ½è§£æ±ºï¼š

ä¸€æ¨£å¯ä»¥å“¦ï¼ progress bar å¾ˆé †ã€æ¨™é¡Œçš„åˆ‡æ›ä¹Ÿä¸æœƒå¡

è¶…çŒ›
-->

---

# è¨˜æ†¶åŒ–çš„ä¾‹å­ - æ¯”è¼ƒå€¼çš„å•é¡Œ

<Video src="/ch-5/5-7/4.mp4" />

<!--
æ¥ä¸‹ä¾†æ˜¯ useMemo å’Œ useCallback çš„å ´æ™¯ï¼š

ä¸€æ¨£è§£æ±ºäº†å› ç‚ºæ¯”è¼ƒå€¼é€ æˆ `useEffect` ç˜‹ç‹‚åŸ·è¡Œçš„å•é¡Œã€‚

èªªçœŸçš„ï¼Œç›®å‰çš„ React Compiler çš„æ•ˆæœæ˜¯è »é©šè‰·åˆ°æˆ‘çš„ï¼Œé€™äº›å¸¸è¦‹çš„é™·é˜±å ´æ™¯éƒ½è¢«è§£æ±ºäº†ï¼
-->

---

# è¨˜æ†¶åŒ–çš„ä¾‹å­ - å‚³å…¥ inline function å’Œ Children çš„ä¾‹å­

```jsx
export default function Page() {
  'use memo';

  const [count, setCount] = useState(0);
  console.log('parent re-render', count);

  return (
    <div>
      <Child data={1} onClick={() => console.log('click')} />{' '}
      {/* â˜ï¸ inline function */}
      <Button onClick={() => setCount(count + 1)}>Click me</Button>
    </div>
  );
}

function Child({ data, onClick }) {
  console.log('child re-render', data);
  return <button onClick={onClick}>Click me</button>;
}
```

<!--
æ¥è‘—æˆ‘å¾ˆå¥½å¥‡å‚³å…¥ inline function æˆ–æ˜¯ inline object çµ¦å­çµ„ä»¶çš„è©±ï¼Œé‚„æœƒè¢«è¨˜æ†¶åŒ–å—ï¼Ÿ

å…ˆä¾†çœ‹ç¨‹å¼ç¢¼è¤‡ç¿’ä¸€ä¸‹ï¼š

æˆ‘å€‘åœ¨ children å‚³å…¥ inline functionï¼Œå› ç‚ºæ¯æ¬¡ re-render æ™‚é€™å€‹ inline function åƒè€ƒå€¼éƒ½æœƒæ”¹è®Š

åœ¨ä»¥å¾€ï¼Œé€™æœƒå°è‡´ react.memo å¤±æ•ˆã€‚

é‚£ç¾åœ¨æœ‰äº† React Compiler èƒ½ä¸èƒ½è§£æ±ºé€™å€‹å•é¡Œå‘¢ï¼Ÿ
-->

---

# è¨˜æ†¶åŒ–çš„ä¾‹å­ - å‚³å…¥ inline function å’Œ Children çš„ä¾‹å­

<Video src="/ch-5/5-7/5.mp4" />

<!--
ä¸€æ¨£å¯ä»¥è§£æ±ºå“¦ï¼

å¯ä»¥çœ‹åˆ°ç‹€æ…‹æ”¹è®Šæ™‚ï¼Œchildren ä¸æœƒè¢« re-render

çœ‹èµ·ä¾†æˆ‘å€‘å¹¾ä¹ä¸éœ€è¦æ‰‹å‹•å»è¨­ç½® React.memo äº†ï¼
-->

---

# è¨˜æ†¶åŒ–çš„ä¾‹å­ - å‚³å…¥ inline function å’Œ Children çš„ä¾‹å­

```jsx
export default function Page() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <button onClick={() => setCount(count + 1)}>Click me</button>

      {/* ğŸ‘‡ å‚³å…¥ children æœƒä¸ç‚ºå½±éŸ¿å‘¢ï¼Ÿ */}
      <Child>
        <p>Child</p>
      </Child>
    </div>
  );
}
```

<!--
é‚£ children æœƒä¸æœƒå½±éŸ¿è¨˜æ†¶åŒ–çš„æ•ˆæœå‘¢ï¼Ÿ

ç†è«–ä¸Šæ‡‰è©²ä¹Ÿæ˜¯æ²’å•é¡Œï¼Œå› ç‚º Children å¯ä»¥æƒ³åƒæˆæ˜¯ä¸€å€‹ inline objectï¼š
-->

---

# è¨˜æ†¶åŒ–çš„ä¾‹å­ - å‚³å…¥ inline function å’Œ Children çš„ä¾‹å­

<Video src="/ch-5/5-7/6.mp4" />

<!--
ä¹Ÿæ²’å•é¡Œï¼Œchildren  ä¹Ÿä¸æœƒè¢« re-renderï¼çœŸæ˜¯å¤ªè®šäº†ã€‚
-->

---

# context çš„å•é¡Œ

<Video src="/ch-5/5-7/7.mp4" />

<!--
é€™å€‹æ˜¯æˆ‘æœ€å¥½å¥‡çš„å•é¡Œå•Šï¼React Compiler åˆ°åº•èƒ½ä¸èƒ½è§£æ±ºå‰é¢æåˆ° context çš„å•é¡Œå‘¢ï¼Ÿ

éå¸¸å¯æƒœï¼Œä»–ä¸èƒ½è§£æ±ºé€™å€‹å•é¡Œâ€¦
-->

---

# context çš„å•é¡Œ

```jsx
function MenuProvider({ children }) {
  'use memo';

  const [isOpen, setIsOpen] = useState(false);

  const openMenu = () => setIsOpen(true);
  const closeMenu = () => setIsOpen(false);
  const toggleMenu = () => setIsOpen((prev) => !prev);

  return (
    <MenuContext.Provider value={{ isOpen, openMenu, closeMenu, toggleMenu }}>
      {children}
    </MenuContext.Provider>
  );
}
```

<!--
ä¸éä¹Ÿéå¸¸åˆç†ï¼Œä»¥ React Compiler çš„è§’åº¦ä¾†çœ‹

Provider çš„ value å°±æ˜¯ä¸€å€‹è¦è·Ÿè‘—ç‹€æ…‹ä¾†æ›´æ–°çš„ç‰©ä»¶ï¼š
-->

---

# çœŸå¯¦å ´æ™¯çš„è¡¨ç¾

èª²ç¨‹å¹³å°å°ˆæ¡ˆï¼š

<Video src="/ch-5/5-7/8.mp4" class="max-h-[400px]" />

<!--
React Compiler é€šéäº†å¹¾ä¹å‰é¢æ‰€æœ‰çš„æ¸¬è©¦ï¼Œå› æ­¤æˆ‘æƒ³æŠŠå®ƒå¯¦éš›æ‡‰ç”¨åœ¨çœŸå¯¦å°ˆæ¡ˆè£¡ï¼Œæ–¼æ˜¯æº–å‚™äº†ä¸€å€‹èª²ç¨‹å¹³å°çš„ç¤ºç¯„å°ˆæ¡ˆã€‚

é€™å€‹å¹³å°å¯ä»¥ç¯©é¸å…è²»æˆ–ä»˜è²»èª²ç¨‹ã€ä¾ç…§åƒ¹æ ¼æˆ–ç†±åº¦æ’åºï¼Œä¹Ÿå…·å‚™åˆ†é åŠŸèƒ½ã€‚

å¾ä¸‹é¢çš„å½±ç‰‡å¯ä»¥çœ‹åˆ°ï¼Œä¸è«–æ˜¯åˆ‡æ›æ’åºé‚„æ˜¯åˆ‡æ›ç¯©é¸æ¢ä»¶æ™‚ï¼Œæ•´å€‹ä¸»è¦çµ„ä»¶ï¼ˆåŒ…å« Filterã€Sortã€Cardï¼‰éƒ½æœƒé‡æ–° Re-renderã€‚

ç†è«–ä¸Šï¼Œé€™äº›çµ„ä»¶å·²ç¶“é€é React Compiler è¨˜æ†¶åŒ–äº†ï¼Œä¸æ‡‰è©²å…¨éƒ¨éƒ½è¢«é‡æ–°æ¸²æŸ“ï¼Œå°å§ï¼æ‰€ä»¥æˆ‘å€‘ä¾†çœ‹çœ‹å•é¡Œåœ¨å“ªã€‚
-->

---

````md magic-move
```jsx {all|2|6|8|10-14}
export function CoursesMain() {
  const { data, filters, updateFilters } = useCoursesList();

  return (
    <>
      <CoursesFilter filters={filters} onFilterChange={updateFilters} />

      <CoursesSort filters={filters} onFilterChange={updateFilters} />

      <div className="grid grid-cols-1 gap-1 lg:grid-cols-3 lg:gap-8">
        {data.courses.map((course) => (
          <CoursesCard data={course} key={course.id} />
        ))}
      </div>
    </>
  );
}
```

```jsx {all|6-9}
export function useCoursesList() {
	const searchParams = useSearchParams();
	const router = useRouter();

	// Parse filters from URL search params
	const filters: CoursesFilters = useMemo(
		() => parseFiltersFromSearchParams(searchParams),
		[searchParams],
	);

	const query = useQuery({
		queryKey: ['courses', filters],
		queryFn: async () => await fetchCourses(filters),
		retry: 2,
	});

	const updateFilters = (newFilters: Partial<CoursesFilters>) => {
		const params = new URLSearchParams(searchParams.toString());
		params.set('page', '1'); // Reset to first page when filters change

		for (const key in newFilters) {
			const typedKey = key as keyof CoursesFilters;
			const value = newFilters[typedKey];

			params.set(typedKey, String(value));
		}

		router.push(`/courses?${params.toString()}`);
	};

	return {
		...query,
		filters,
		updateFilters,
	};
}
```

```jsx
{
	sortBy: 'price', // æ ¹æ“šåƒ¹æ ¼æ’åº
	filterBy: 'free', // ç¯©é¸å…è²»å…§å®¹
}

```

```jsx {11-15|17-29}
export function useCoursesList() {
	const searchParams = useSearchParams();
	const router = useRouter();

	// Parse filters from URL search params
	const filters: CoursesFilters = useMemo(
		() => parseFiltersFromSearchParams(searchParams),
		[searchParams],
	);

	const query = useQuery({
		queryKey: ['courses', filters],
		queryFn: async () => await fetchCourses(filters),
		retry: 2,
	});

	const updateFilters = (newFilters: Partial<CoursesFilters>) => {
		// å…ˆæŠ“åˆ°ç›®å‰çš„ Query Param
		const params = new URLSearchParams(searchParams.toString());

		// æ ¹æ“šåŸå…ˆçš„ Query Param åŠ ä¸Šæœ€æ–° filter çš„å±¬æ€§
		for (const key in newFilters) {
			const value = newFilters[key];
			params.set(key, String(value));
		}

		// è·³è½‰é é¢
		router.push(`/courses?${params.toString()}`);
	};

	return {
		...query,
		filters,
		updateFilters,
	};
}
```
````

<!--
é€™å€‹æ˜¯æ•´å€‹ç¨‹å¼ç¢¼çš„ç°¡åŒ–ç‰ˆï¼Œä¿ç•™æ‰€æœ‰èˆ‡å•é¡Œç›¸é—œçš„å…§å®¹ï¼š

æœ‰ï¼š

[click]
`useCoursesList`

[click]
`CoursesFilter`

[click]
`CoursesSort`

[click]
`CoursesCard`

[click]

é‚£ useCoursesList æ˜¯è‡ªå·±å°è£çš„ Hookï¼Œç¨‹å¼ç¢¼åœ¨é€™é‚Šï¼Œå¯ä»¥çœ‹æˆä¸‰å¤§éƒ¨åˆ†ï¼š

[click]
filtersï¼šç”± searchParams è§£æå‡ºç›®å‰çš„æ’åºèˆ‡ç¯©é¸æ¢ä»¶ï¼Œä»–æ˜¯ä¸€å€‹ç‰©ä»¶ï¼Œçµæ§‹é¡ä¼¼æ–¼

[click]
é€™æ¨£ï¼Œä¸€å€‹ sortBy å’Œ filterBy çš„å±¬æ€§

[click]
ç¬¬äºŒå€‹éƒ¨åˆ†æ˜¯ TanStack Query çš„ useQueryã€‚é‚£é€™å€‹æ‡‰è©²æ²’æœ‰ä»€éº¼å¥½èªªçš„ï¼Œå¤§å®¶æ‡‰è©²å¤šå°‘ç”¨éƒ½é

[click]
ç¬¬ä¸‰å€‹éƒ¨åˆ†å°±æ˜¯ updateFiltersï¼šä»–æ˜¯ä¸€å€‹è² è²¬æ›´æ–°ç¯©é¸èˆ‡æ’åºå‡½æ•¸ã€‚

ï¼ˆç…§è‘—è¨»è§£è§£é‡‹ï¼‰

é‚£ç¨‹å¼ç¢¼æœ‰ç°¡åŒ–éäº†ï¼Œä½†å¤§æ¦‚å°±æ˜¯é€™å€‹é‚è¼¯ã€‚
-->

---

# å„ªåŒ–çœŸå¯¦å ´æ™¯ä¸‹çš„ Re-render

```jsx
<CoursesFilter filters={filters} onFilterChange={updateFilters} />
```

<v-click>

Query Param è®Šå‹• â†’ filters è®Šå‹• â†’ `<CoursesFilter>` è·Ÿè‘—é‡æ–°æ¸²æŸ“ã€‚

</v-click>

<v-click>

å¦‚æœè¦é¿å…ä¸å¿…è¦çš„ Re-renderï¼Œåªéœ€è¦å‚³å…¥åŸå§‹å€¼å°±å¥½ï¼š

````md magic-move
```jsx
<CoursesFilter
  filterBy={filters.filterBy} // ğŸ‘ˆ åŸå§‹å€¼
  onFilterChange={updateFilters}
/>
```

```jsx
<CoursesFilter
  filterBy={filters.filterBy}
  onFilterChange={updateFilters} // ğŸ‘ˆ ä»–ä¹Ÿåœ¨æé¬¼
/>
```

```jsx
const updateFilters = (newFilters: Partial<CoursesFilters>) => {
  // å…ˆæŠ“åˆ°ç›®å‰çš„ Query Param
  const params = new URLSearchParams(searchParams.toString()); // ğŸ‘ˆ å•é¡Œåœ¨é€™è¡Œ
  // ...
};
```

```jsx
const searchParams = useSearchParams();

const updateFilters = (newFilters: Partial<CoursesFilters>) => {
  // å…ˆæŠ“åˆ°ç›®å‰çš„ Query Param
  const params = new URLSearchParams(searchParams.toString()); // ğŸ‘ˆ å•é¡Œåœ¨é€™è¡Œ
  // ...
};
```
````

</v-click>

<v-click>

useSearchParams æœƒéš¨ URL æ”¹è®Šè€Œé‡æ–°ç”¢ç”Ÿæ–°ç‰©ä»¶

</v-click>

<!--
åœ¨æª¢æŸ¥æ•´é«”é‚è¼¯å¾Œï¼Œæˆ‘æ‰¾åˆ°äº†é€ æˆ Re-render çš„é—œéµåŸå› ã€‚

æˆ‘å€‘ä»¥ `<CoursesFilter>` ç‚ºä¾‹ï¼š

ç”±æ–¼æˆ‘å°‡æ•´å€‹ filters ç‰©ä»¶å‚³é€²å­å…ƒä»¶ï¼Œå› æ­¤æ¯ç•¶ç¯©é¸æ¢ä»¶æ”¹è®Šæ™‚ï¼Œå°±æœƒç…§æˆä»¥ä¸‹é‚è¼¯ç™¼ç”Ÿï¼š

[click]
Query Param è®Šå‹• â†’ filters è®Šå‹• â†’ `<CoursesFilter>` è·Ÿè‘—é‡æ–°æ¸²æŸ“ã€‚

[click]

å¦‚æœè¦é¿å…ä¸å¿…è¦çš„ Re-renderï¼Œå…¶å¯¦åªéœ€è¦å‚³å…¥åŸå§‹å€¼ï¼Œä¾‹å¦‚ filterBy å­—ä¸²å³å¯

[click]

ä½†å¯¦éš›æ¸¬è©¦å¾Œç™¼ç¾ `<CoursesFilter>` é‚„æ˜¯è¢«é‡æ–°æ¸²æŸ“äº†ã€‚é€™æ„å‘³è‘—å•é¡Œä¸åªæ˜¯ filters

é€£ `updateFilters` é€™å€‹ function ä¹Ÿåœ¨æé¬¼ã€‚

[click]
é€²ä¸€æ­¥åˆ†æå¾Œï¼Œæˆ‘ç™¼ç¾å•é¡Œå‡ºåœ¨é€™ä¸€è¡Œï¼š

[click]
å› ç‚º searchParams ä¾†è‡ª Next.js çš„ useSearchParams

[click]
å®ƒæœ¬èº«æœƒéš¨ URL æ”¹è®Šè€Œé‡æ–°ç”¢ç”Ÿæ–°ç‰©ä»¶

å°è‡´ updateFilters ç„¡æ³•è¢«è¨˜æ†¶åŒ–ï¼Œæ¯æ¬¡ searchParams æ›´æ–°æ™‚éƒ½æœƒç”Ÿæˆæ–°çš„ updateFilters

æ­¤æ™‚æ‰€æœ‰æ¥æ”¶ updateFilters çš„å­çµ„ä»¶ä¹Ÿæœƒé‡æ–°æ¸²æŸ“ã€‚
-->

---

# å„ªåŒ–çœŸå¯¦å ´æ™¯ä¸‹çš„ Re-render

```jsx
<CoursesFilter filters={filters} onFilterChange={updateFilters} />
```

Query Param è®Šå‹• â†’ filters è®Šå‹• â†’ `<CoursesFilter>` è·Ÿè‘—é‡æ–°æ¸²æŸ“ã€‚

å¦‚æœè¦é¿å…ä¸å¿…è¦çš„ Re-renderï¼Œåªéœ€è¦å‚³å…¥åŸå§‹å€¼å°±å¥½ï¼š

```jsx
const searchParams = useSearchParams(); // âŒ ä¸è¦ç”¨é€™å€‹

const updateFilters = (newFilters: Partial<CoursesFilters>) => {
  // å…ˆæŠ“åˆ°ç›®å‰çš„ Query Param
  const params = new URLSearchParams(window.location.search); // ğŸ‘ˆ æ”¹æˆåŸç”Ÿçš„ API
  // ...
};
```

æ”¹ç”¨åŸç”Ÿçš„ window.location.search

<!--
é‚£è¦è§£æ±ºé€™å€‹å•é¡Œï¼Œå…¶å¯¦ä¹Ÿä¸é›£

åªè¦é¿å…åœ¨ updateFilters è£¡ä½¿ç”¨ useSearchParams çš„å›å‚³å€¼ï¼Œæ”¹ç”¨åŸç”Ÿçš„ window.location.search å³å¯

é€™æ¨£ updateFilters å°±ä¸æœƒå› ç‚º searchParams æ”¹è®Šè€Œé‡æ–°è¢«å»ºç«‹ï¼ŒReact Compiler ä¹Ÿèƒ½æ­£ç¢ºè¨˜æ†¶åŒ–å…ƒä»¶ï¼Œé¿å…ä¸å¿…è¦çš„ Re-renderã€‚
-->

---

<Video src="/ch-5/5-7/9.mp4" />

<!--
å¾å½±ç‰‡ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œç•¶æˆ‘æ›´æ”¹æ’åºé‚è¼¯æ™‚ï¼ŒFIlter ä¸æœƒè¢« Re-render äº†ï¼å®Œç¾ï¼
-->

---

# ç¸½çµ

<v-clicks>

React Compiler èƒ½åœ¨å¤šæ•¸æƒ…æ³ä¸‹ç›´æ¥å¸¶ä¾†æ•ˆèƒ½å„ªåŒ–

ä½†é€™ä¸¦ä¸è¡¨ç¤ºæˆ‘å€‘å°±èƒ½å®Œå…¨å¿½ç•¥å‰é¢æåˆ°çš„å…¶ä»–å„ªåŒ–æ–¹å¼

åœ¨æŸäº›ç‰¹å®šå ´æ™¯ä¸­ï¼Œæˆ‘å€‘ä»éœ€è¦ç†è§£åŸå§‹å€¼èˆ‡åƒè€ƒå€¼å°çµ„ä»¶é‡æ–°æ¸²æŸ“çš„å½±éŸ¿

åªæœ‰çœŸæ­£æŒæ¡é€™äº›åº•å±¤æ¦‚å¿µï¼Œæ‰èƒ½**åœ¨å¿…è¦æ™‚åšå‡ºç²¾æº–è€Œæœ‰æ•ˆçš„æ•ˆèƒ½å„ªåŒ–ã€‚**

</v-clicks>

<!--
æœ€å¾Œç°¡å–®æ•´ç†ä¸€ä¸‹ï¼ŒReact Compiler çš„ç¢ºéå¸¸å¼·å¤§ï¼Œä¸¦ä¸”èƒ½åœ¨å¤šæ•¸æƒ…æ³ä¸‹ç›´æ¥å¸¶ä¾†æ•ˆèƒ½å„ªåŒ–ï¼Œå¹¾ä¹æ˜¯å¯ä»¥ç„¡è…¦åœ°å»ä½¿ç”¨ã€‚

ä½†é€™ä¸¦ä¸è¡¨ç¤ºæˆ‘å€‘å°±èƒ½å®Œå…¨å¿½ç•¥ useMemoã€useCallbackï¼Œæˆ–å‰é¢æåˆ°çš„å…¶ä»–å„ªåŒ–æ–¹å¼ã€‚

é€™äº›æŠ€å·§é™¤äº†èƒ½é¿å…ä¸å¿…è¦çš„ Re-renderï¼Œæ›´é‡è¦çš„æ˜¯èƒ½ä¿ƒä½¿æˆ‘å€‘å¯«å‡ºçµæ§‹æ¸…æ™°ã€æ„åœ–æ˜ç¢ºçš„ç¨‹å¼ç¢¼ã€‚


å¦å¤–ï¼Œåœ¨æŸäº›ç‰¹å®šå ´æ™¯ä¸­ï¼Œæˆ‘å€‘ä»éœ€è¦ç†è§£åŸå§‹å€¼èˆ‡åƒè€ƒå€¼å°çµ„ä»¶é‡æ–°æ¸²æŸ“çš„å½±éŸ¿ã€‚

åªæœ‰çœŸæ­£æŒæ¡é€™äº›åº•å±¤æ¦‚å¿µï¼Œæ‰èƒ½åœ¨å¿…è¦æ™‚åšå‡ºç²¾æº–è€Œæœ‰æ•ˆçš„æ•ˆèƒ½å„ªåŒ–ã€‚
-->
